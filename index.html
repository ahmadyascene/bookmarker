<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">
  <title>Bookmarker</title>
  <link rel="icon" href="favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Encode+Sans+Expanded:wght@300;400&family=Pacifico&display=swap" rel="stylesheet">
  <style>
@font-face {font-family: s; src: url(fa-solid-900.woff2);}
@font-face {font-family: b; src: url(fa-brands-400.woff2);}

::selection {color: #fff; background: #596e79;}
html {position: relative;}
@keyframes fadeIn {0% {opacity: 0;}}
body {color: #212529; font-family: 'Encode Sans Expanded', system-ui;
  min-height: calc(100dvh - 2.75em); padding-bottom: 2.75em; margin: 0 .75em;
  display: flex; flex-flow: column; justify-content: center;
  animation: .75s cubic-bezier(.75,0,.75,.9) fadeIn;}
body:has(>#background:checked) {background: #f0ece3;}
@media (width>=36em) {body {width: 32.25em; margin-inline: auto;}}
@media (width>=48em) {body {width: 43.5em;}}

:is(#background,label,.d1,.be,.bd)::before {font-family: s;}
h1, .ib.b {font-family: Pacifico, system-ui;}
.ib {font-size: inherit; line-height: 1.5; font-family: inherit;
  border: .0625em solid; border-radius: .5em;}
.i {color: inherit; width: 100%; padding: .625em .75em; border-color: #bec3c9;
  box-sizing: border-box; transition: border-color .15s;}
label:not(:has(>span))>.i {margin-block: .3125em .75em;}
.i:focus {border-color: #596e79; outline: 0;}
button:enabled {-webkit-tap-highlight-color: #0000; cursor: pointer;}
a {-webkit-tap-highlight-color: #0000; outline: 0;}
a:not(:hover,:focus-visible) {text-decoration: none;}

#background {appearance: none; padding: 1.2em; border-radius: .9em; margin: 0;
  position: absolute; top: 0; right: 0; cursor: pointer;}
#background:focus-visible {outline: .075em solid #596e79;
  outline-offset: -.375em;}
#background::before {content: '\f042'; color: #596e79; background: #f0ece3;
  font-size: 1.35em; border-radius: 50%;}
#background:checked::before {background: #fff;}

h1 {color: #596e79; font-weight: 400; font-size: 2.5em; width: fit-content;
  margin-inline: auto; position: relative;}
h1::before {content: ''; background: #dfd3c3; border-radius: 0 0 .15em .15em;
  position: absolute; inset: 1.05em 0 .3em; z-index: -1; transition: top .3s;}
h1:hover::before {top: .68em;}

label:has(>#name)::before {content: '\e0bb';}
label:has(>#url)::before {content: '\f0c1';}

.d {box-shadow: .3em .3em .3em #0003; font-size: .9em; line-height: 1.7361;
  max-width: min(25em,calc(100% - 3.2639em - 26px));
  padding: .8333em .5556em .8333em 2.7083em; border: .069445em solid #bec3c9;
  border-radius: .5em; z-index: 1;}
.d::before {position: absolute; left: .5556em;}
.d0::before {content: '!'; color: #fff; background: #ff8c00; font-weight: 700;
  text-align: center; width: 1.7361em; border-radius: .25em;}
.d1::before {content: '\f058'; color: #596e79; scale: 1.7361;
  transform-origin: 0;}

.b {color: #dfd3c3; background: #596e79; font-size: 1.25em; width: 100%;
  padding: .35em .75em; border-color: #0000; transition: background .15s;}
.b:focus-visible {outline: .0625em solid #596e79;}
.b:enabled:hover {background: #647b87;}
.b:enabled:active {background: #4e606a;}

label:has(>span) {margin-block: .75em; position: relative;}
label:has(>.is)::before {content: '\f002'; color: #6c757d; position: absolute;
  top: 50%; left: .8125em; translate: 0 -50%; transition: color .15s;}
label:has(>.is:focus)::before {color: #596e79;}
label>span {color: #6c757d; text-overflow: ellipsis; white-space: nowrap;
  max-width: calc(100% - 1.5em); padding-inline: .25em; overflow: hidden;
  position: absolute; transform-origin: 0; translate: .5625em -50%;
  transition: color .15s, background .15s, top .15s, translate .15s, scale .15s;
  -webkit-user-select: none; user-select: none; pointer-events: none;}
span:has(+.is) {max-width: calc(100% - 2.875em); translate: 1.9375em -50%;}
label>span:not(.lu) {top: 50%;}
span.lu {background: #fff; top: 0; translate: .625em -50%; scale: .75;}
label:has(>input:focus)>span {color: #596e79;}
.is {padding-left: 2.125em;}

div:has(>table) {background: #fff; overflow: auto; border-radius: .5em;
  margin-bottom: 1em;}
table {width: 100%; border-spacing: 0;}
tbody>:nth-child(n+2)>* {border-top: .0625em solid #bec3c9;}
td {text-align: center; padding: .75em;}

table .i {appearance: textfield; font-size: revert; text-align: center;
  width: 3.75em; aspect-ratio: 1.618034; padding: 0;}
table .i::-webkit-inner-spin-button {display: none;}

table a {color: #36c; white-space: nowrap; display: inline-flex;
  align-items: center;}
table a:visited {color: #6b4ba1;}
table a:is(:hover,:focus-visible) {color: #447ff5;}
table a:active {color: #2a4b8d;}
table a>img {width: 1em;}

.be, .bd {background: 0; padding: .375em .75em; border-color: #0000;
  transition: color .15s, background .15s;}
.be {color: #17a2b8;}
.be:focus-visible {outline: .0625em solid #0baccc;}
.be:hover {color: #fff; background: #17a2b8;}
.be:active {color: #fff; background: #117c8d;}
.be::before {content: '\f044';}
.bd {color: #dc3545;}
.bd:focus-visible {outline: .0625em solid #e15361;}
.bd:hover {color: #fff; background: #dc3545;}
.bd:active {color: #fff; background: #a52834;}
.bd::before {content: '\f1f8';}

footer {padding-bottom: .25em; display: flex; flex-flow: wrap;
  justify-content: center; align-items: center; position: absolute;
  inset: auto 0 0;}
footer>ul {list-style: none; padding-left: 0; margin-block: 0; display: flex;}
footer a {color: inherit; line-height: 2em; font-family: b; text-align: center;
  width: 2em; display: block;}
footer ::before {vertical-align: bottom;}
footer [href$=com]::before {content: 'AY'; font-size: .75em;}
footer [href*=github]::before {content: '\f09b';}
footer [href*=linkedin]::before {content: '\f08c';}
footer [href*=wa]::before {content: '\f232';}
footer>small {color: #000; font-weight: 300; letter-spacing: .0375em;
  padding-inline: .6em;}
  </style>
</head>
<body>
  <input type="checkbox" id="background">
  <h1>Bookmarker</h1>
  <form>
    <label>&nbsp;Name
      <input placeholder="e.g. Google" autofocus id="name" class="ib i">
    </label>
    <dialog></dialog>
    <label>&nbsp;URL
      <!--type="url" requires a scheme even though we'd assume "http://"-->
      <input placeholder="e.g. google.com" id="url" class="ib i">
    </label>
    <button class="ib b">Bookmark</button>
  </form>
  <label><span>Search bookmarks</span>
    <input type="search" id="search" class="ib i is">
  </label>
  <div><table><tbody></tbody></table></div>
  <footer>
    <ul>
      <li><a href="https://ahmadyascene.com" target="_blank"></a></li>
      <li><a href="https://github.com/ahmadyascene" target="_blank"></a></li>
      <li><a href="https://linkedin.com/in/ahmadyascene" target="_blank"></a></li>
      <li><a href="https://wa.me/+201063582917" target="_blank"></a></li>
    </ul>
    <small>&copy; 2025 Ahmad Yascene</small>
  </footer>
  <script>
'use strict';
const background=document.getElementById('background'),
  name=document.getElementById('name'), form=name.parentElement.parentElement,
  dialog=form.querySelector('dialog'), url=document.getElementById('url'),
  button=form.querySelector('button'), search=document.getElementById('search'),
  table=document.querySelector('tbody'),
  bookmarks=JSON.parse(localStorage.getItem('bookmarks'))||[],
  render=()=>{
    if (bookmarks.length) {search.parentElement.hidden=false;
      let rows=''; for (const [i,{name,url}] of bookmarks.entries())
        if (!search.value||
          name.toLowerCase().includes(search.value.toLowerCase())||
          url.toLowerCase().includes(search.value.toLowerCase()))
          rows+=`<tr>
            <td><input type=number value=${i+1} data-i=${i} class="ib i"></td>
            <td><a href="${url}" target="_blank">
              <img src=https://www.google.com/s2/favicons?domain=${url} alt="favicon">
              &nbsp;${name}
            </a></td>
            <td><button class="ib be" data-i=${i}>&nbsp;Edit</button></td>
            <td><button class="ib bd" data-i=${i}>&nbsp;Delete</button></td>
          </tr>`;
      table.innerHTML=rows||'<tr><td colspan="4">No search results found</td></tr>';
      for (const i of table.querySelectorAll('input')) i.onchange=()=>{
        const v=parseInt(i.value);
        bookmarks.splice(v>0?v-1:v<-1?v+1:v==-1?bookmarks.length:0,0,
          bookmarks.splice(i.dataset.i,1)[0]);
        update();};}
    else {search.parentElement.hidden=true; table.innerHTML='';}},
  update=()=>{localStorage.setItem('bookmarks',JSON.stringify(bookmarks));
    i=bookmarks.length; form.reset(); button.textContent='Bookmark'; render();},
  message=(m,b=0)=>{dialog.className='d d'+b; dialog.textContent=m;
    clearTimeout(t); dialog.show(); t=setTimeout(()=>dialog.close(),4000);};
let i=bookmarks.length, t;

background.checked=JSON.parse(localStorage.getItem('background'));
render();

onload=()=>{ //chrome
  if (search.value) render(); //chrome
  for (const i of document.querySelectorAll('span+.i')) {
    if (i.value) i.previousElementSibling.className='lu';
    i.oninput=()=>{i.previousElementSibling.className='lu'; //firefox
      if (i==search) {render(); search.oninput=render;} else i.oninput=null;};
    i.onfocus=()=>i.previousElementSibling.className='lu';
    i.onblur=()=>{if (!i.value&&!i.matches(':focus'))
      i.previousElementSibling.className='';};}};

background.onchange=()=>
  localStorage.setItem('background',JSON.stringify(background.checked));

form.onsubmit=e=>{e.preventDefault();
  if (!/^(?:https?:\/\/)?(?:(?:\b[a-z\d-]{1,64}\b\.){1,128}[a-z]{2,64}|(?:(?:\d{1,3}\.){3}\d{1,3}))(?:\:0*(?:[0-5]?\d{1,4}|6(?:[0-4]\d{1,3}|5(?:[0-4]\d{1,2}|5(?:[012]\d|3[0-5])))))?(?:\/[\w%.~+-]*)*(?:\?[\w;&%.~+=-]*)?(?:\#[\w-]*)?$/i
    .test(url.value)) {message('Invalid URL'); url.focus(); return;}
  const l=url.value.includes('://')?url.value:'http://'+url.value;
  for (const {url:ol} of bookmarks) if (ol==l&&ol!=bookmarks[i]?.url) {
    message('Already bookmarked'); url.focus(); return;}
  bookmarks.splice(i,1,{name:name.value,url:l}); update();
  message('Bookmark saved',1); name.focus();};

url.oninput=()=>url.value=url.value.replaceAll(' ','');

table.onclick=({target})=>{
  if (target.classList.contains('be')) {
    i=target.dataset.i; name.value=bookmarks[i].name;
    url.value=bookmarks[i].url; button.textContent='Save'; name.focus();}
  else if (target.classList.contains('bd')) {
    bookmarks.splice(target.dataset.i,1); update();}};
  </script>
</body>
</html>